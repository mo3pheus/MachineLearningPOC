package org.sanket.codingGym.DataMining.algorithms;

/* general java imports */
import java.io.File;
import java.io.FileNotFoundException;
import java.io.IOException;

/* machine learning imports */

import net.sf.javaml.clustering.Clusterer;
import net.sf.javaml.clustering.KMeans;
import net.sf.javaml.core.Dataset;
import net.sf.javaml.tools.data.FileHandler;

/**
 * @author sanket This class uses the machine learning library to cluster given
 *         data
 */
public class KMeansClusterer {
	Clusterer	clusterer;
	Dataset		dataset;

	public KMeansClusterer(String dataLocation, int numColumns, String delimiter) {
		try {
			clusterer = new KMeans();
			dataset = FileHandler.loadDataset(new File(dataLocation));
		} catch (FileNotFoundException fne) {
			fne.printStackTrace(System.out);
		} catch (IOException io) {
			io.printStackTrace(System.out);
		}

		System.out.println("Dataset size = " + dataset.size());
	}

	public void cluster() {
		System.out.println("Dataset size = " + dataset.size());
		Dataset[] clusters = clusterer.cluster(dataset);

		int j = 1;
		for (Dataset d : clusters) {
			for (int i = 0; i < d.size(); i++) {
				System.out.println(
						" Class = " + j + " sampleId = " + d.get(i).getID() + " sample :: " + d.get(i).entrySet());
			}
			j++;
		}

	}
}
